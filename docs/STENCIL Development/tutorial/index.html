<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Example extending STENCIL tutorial | STENCIL</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://github.com/CEGRcode/stencil/docs/STENCIL Development/tutorial"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Example extending STENCIL tutorial | STENCIL"><meta data-react-helmet="true" name="description" content="---"><meta data-react-helmet="true" property="og:description" content="---"><link data-react-helmet="true" rel="icon" href="/stencil/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/CEGRcode/stencil/docs/STENCIL Development/tutorial"><link data-react-helmet="true" rel="alternate" href="https://github.com/CEGRcode/stencil/docs/STENCIL Development/tutorial" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/CEGRcode/stencil/docs/STENCIL Development/tutorial" hreflang="x-default"><link rel="stylesheet" href="/stencil/assets/css/styles.814177fe.css">
<link rel="preload" href="/stencil/assets/js/runtime~main.ecd7399f.js" as="script">
<link rel="preload" href="/stencil/assets/js/main.d3fbc737.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/stencil/"><div class="navbar__logo"><img src="/stencil/img/logo.svg" alt="STENCIL" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/stencil/img/logo.svg" alt="STENCIL" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">STENCIL</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/stencil/docs/Getting Started/quick">Docs</a><a href="https://github.com/CEGRcode/stencil" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/stencil/docs/Getting Started/quick">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/stencil/docs/STENCIL Development/codingguidelines">STENCIL Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stencil/docs/STENCIL Development/codingguidelines">Coding Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/stencil/docs/STENCIL Development/tutorial">Development tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stencil/docs/STENCIL Development/galaxy">Galaxy integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stencil/docs/STENCIL Development/nivoplot">Dynamic plot JSON format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stencil/docs/STENCIL Development/layout">Configure layouts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stencil/docs/STENCIL Development/apiaccess">API access</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/stencil/docs/Production Deployment/docker">Production Deployment</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Example extending STENCIL tutorial</h1></header><hr><h1>Overview for adding a <em>nivo</em> chart</h1><p>This tutorial after you have installed necessary packages, and you can see the existing charts. This also assumes you have database installed and you can experiment with mongoDB such as dropping the database, viewing the database for experimental purposes. Later on when data is being posted to database, you should be able to see the data there or drop the database and post it again.</p><p>To add the charts in the stencil app, one should be familiar with APIs and methods in Nivo. Nivo documentation has a lot of details on it but most important thing to consider are</p><ul><li><strong>nivo Components</strong><ul><li>Install each component as required.</li><li>Look into the parameters that are to be provided.</li><li>Some of the parameters are by default provided while others are required.</li><li>Check the data format of the input.</li></ul></li></ul><p>Add (install) the chart component in the package.json to install it and make it available to use later on as well.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">npm install</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="add-the-components-to-stencil">Add the components to STENCIL<a class="hash-link" href="#add-the-components-to-stencil" title="Direct link to heading">​</a></h3><p>Navigate to <strong>STENCIL &gt; frontend &gt; src &gt; Components &gt; Charts</strong></p><p>Some of the charts are already added there. Similar to these charts, make a new javascript file for adding the component for the intended chart.</p><p>For example: <em>StreamPlot_stencil.js</em></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="checklist-for-the-chartjs-file">Checklist for the <em>chart</em>.js file.<a class="hash-link" href="#checklist-for-the-chartjs-file" title="Direct link to heading">​</a></h4><ol><li>Import appropriate function for example <code>Stream</code> and <code>ResponsiveStream</code> for Stream Nivo component and create a function to check for data and pass it.</li><li>The CardContent and/or FullScreenDialog should be provided props.ChartData and props.ChartOptions. The props are made available through a json file from Stencil backend.</li><li>Export the function created.</li></ol><p>Navigate to <strong>STENCIL &gt; frontend &gt; src &gt; Components &gt; Sections</strong></p><p>ImageArray.js builds all the png images declared on the Charts folder. For every chart type, we will have to import the functions exported earlier. Add a case for the chart in the grid object as provided already for number of other charts.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="checklist-for-imagearraysjs">Checklist for ImageArrays.js<a class="hash-link" href="#checklist-for-imagearraysjs" title="Direct link to heading">​</a></h4><ol><li>Always check if the props object are populated with data and options or not. Usually, if these are not provided you will see error or na.png file as a default chart rendered.</li><li>Check for item, size, stepid as well. Refer to src/Config.js for different stepID configurations for different layouts available in the Stencil. This will also give different error if the StepID is not configured properly.</li><li>Very rarely, the component could not fetch the data from backend for which you should look into showLibrary.js. Appropriate console.log on that file is already put to see whether or not data is being fetched from the backend. Confirm that you see the chartdata and chartOptions here as well.</li></ol><p>Navigate to <strong>STENCIL &gt; backend &gt; sampleData &gt; LocalData</strong></p><p>This folder will have the data file needed to create the image. Each of the component require different file structures and parameters. Consult to Nivo website and existing files for the already created charts.</p><p>Prettyprint options online or on your editor can help navigate the json provided.
For example, in <strong>STENCIL &gt; backend &gt; sampleData &gt; localdata &gt; ENCODE &gt; AS &gt; streamplot.json</strong>, we can see nested structure with ‘chartOptions’ and ‘chartdata’ provided. These are used to create the props. Any errors regarding props maybe traced to the parameters and the file provided for the intended chart function.</p><p>Consult <em>nivo</em> website documentation for the parameters to provide, how they should be provided and the parameters( default values and input required ones)</p><p>Once the data is provided, we need a way to tell the backend the layout details required for creating the charts. The layout details, charts data, options are all provided by the backend to frontend.</p><p>Create another file or an entry on the file, for example, sampleData/ATAC-seq_DESeq2 2.json provide details on your project, charts data type, stepid etc. be extra careful on how stepId should be provided for your layout ID. In the URL, provide where the Data file where chartOptions and ChartData were loaded for your chart. The data type should match as well for the type of chart which should match with options and data format it needs.</p><p>Before that we need to register the Data in the Controller module in stencil/backend/api/controllers/librariesController.js  Here for each item/chart , we build a URL. Find the code where it is building the URL. Similar to case “streamplot”, add the case for your chart.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="checklist-for-librariescontrollerjs">Checklist for librariesController.js<a class="hash-link" href="#checklist-for-librariescontrollerjs" title="Direct link to heading">​</a></h4><ol><li>Make sure the case is added for your chart and the datatype match with the datatype declared on the props.</li></ol><p>Navigate to <strong>STENCIL &gt; backend &gt; utils</strong></p><p>This folder has utility functions needed to post data to the Database. Every time any change on the data files included on the LocalData, this should be run to see the update. Update on the frontend such as dimensions etc are live in React but the updates involving the data and sessions are to be reloaded by rebuilding the build process from the beginning.</p><p>In post_all.sh bash script the python commands are provided to post the data. Find your data either in ENCODE or AS or any other subfolders in the localdata folder.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/STENCIL Development/expansion.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/stencil/docs/STENCIL Development/codingguidelines"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Coding Guidelines</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/stencil/docs/STENCIL Development/galaxy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Galaxy integration</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#add-the-components-to-stencil" class="table-of-contents__link toc-highlight">Add the components to STENCIL</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/stencil/assets/js/runtime~main.ecd7399f.js"></script>
<script src="/stencil/assets/js/main.d3fbc737.js"></script>
</body>
</html>